<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>CoreON - ìë£Œ ë“±ë¡</title>
  <style>
    /* ====== CoreON Base (list.htmlê³¼ ë™ì¼ í†¤) ====== */
    :root{
      --bg:#f5f7fb;
      --surface:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --line:#e5e7eb;
      --primary:#1f4bd8;
      --primary-hover:#193db0;
      --shadow:0 8px 24px rgba(17,24,39,.08);
      --radius:14px;

      --danger:#b91c1c;
      --success:#166534;
    }
    *{box-sizing:border-box;}
    body{
      margin:0; padding:0;
      background:var(--bg);
      color:var(--text);
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",Arial,sans-serif;
    }
    a{color:inherit;text-decoration:none;}

    /* ===== Header ===== */
    header{background:var(--surface); border-bottom:1px solid var(--line);}
    .main_div_header{
      max-width:1100px; margin:0 auto;
      padding:24px 20px 14px;
      text-align:center;
    }
    .main_div_header h1{margin:0; font-size:28px; letter-spacing:-.2px;}
    .main_div_header h3{margin:8px 0 0; font-size:14px; color:var(--muted); font-weight:500;}

    .logo-link{ text-decoration:none; color:inherit; }
    .logo-link:hover{ color:inherit; }

    .top-nav{
      display:flex; justify-content:center; align-items:center;
      gap:26px; margin-top:18px; padding:10px 0 6px;
      flex-wrap:wrap;
    }
    .nav-item{
      font-size:14px; font-weight:600;
      padding:8px 6px; border-bottom:2px solid transparent;
      color:var(--text);
    }
    .nav-item:hover{color:var(--primary); border-bottom-color:var(--primary);}
    .nav-item.active{color:var(--primary); border-bottom-color:var(--primary);}
    .nav-item.action{
      padding:8px 12px; border:1px solid var(--line); border-radius:10px;
      background:#fff; font-weight:700;
    }
    .nav-item.action.primary{background:var(--primary); border-color:var(--primary); color:#fff;}
    .nav-item.action.primary:hover{background:var(--primary-hover); border-color:var(--primary-hover);}

    /* ===== Main ===== */
    main{max-width:1100px; margin:0 auto; padding:28px 20px 0;}
    .page-head{
      display:flex; justify-content:space-between; align-items:flex-end;
      gap:12px; flex-wrap:wrap;
      margin: 6px 0 16px;
    }
    .page-title h2{margin:0; font-size:18px; font-weight:800;}
    .page-title p{margin:6px 0 0; font-size:13px; color:var(--muted); line-height:1.6;}

    .card{
      background:var(--surface);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .card-head{
      padding:14px 16px;
      border-bottom:1px solid var(--line);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .card-head .title{
      margin:0;
      font-size:14px;
      font-weight:900;
    }
    .card-head .desc{
      margin:4px 0 0;
      font-size:12px;
      color:var(--muted);
    }
    .card-body{padding:16px;}

    /* ===== Form ===== */
    .form-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:14px;
    }
    .field{
      display:flex;
      flex-direction:column;
      gap:8px;
    }
    .field.full{grid-column: 1 / -1;}
    label{
      font-size:13px;
      font-weight:900;
    }
    .required{
      color:var(--danger);
      font-weight:900;
      margin-left:6px;
      font-size:12px;
    }
    .input, .select, .textarea{
      padding:11px 12px;
      border:1px solid var(--line);
      border-radius:12px;
      outline:none;
      background:#fff;
      font-size:14px;
      color:var(--text);
    }
    .textarea{
      min-height: 220px;
      resize: vertical;
      line-height: 1.6;
    }
    .input:focus, .select:focus, .textarea:focus{
      border-color: rgba(31,75,216,0.45);
      box-shadow: 0 0 0 4px rgba(31,75,216,0.10);
    }
    .help{
      font-size:12px;
      color:var(--muted);
      line-height:1.5;
    }
    .error{
      font-size:12px;
      color:var(--danger);
      font-weight:800;
      display:none;
    }

    /* ===== Buttons ===== */
    .btn{
      border:1px solid var(--line);
      background:#fff;
      padding:11px 14px;
      border-radius:12px;
      font-weight:900;
      cursor:pointer;
      font-size:14px;
      white-space:nowrap;
    }
    .btn.primary{
      background:var(--primary);
      border-color:var(--primary);
      color:#fff;
    }
    .btn.primary:hover{
      background:var(--primary-hover);
      border-color:var(--primary-hover);
      box-shadow:0 6px 16px rgba(31,75,216,0.18);
    }
    .btn.ghost{
      background:#fff;
      border-color: rgba(31,75,216,0.25);
      color: var(--primary);
    }
    .btn.ghost:hover{
      border-color: rgba(31,75,216,0.45);
      box-shadow:0 6px 16px rgba(31,75,216,0.10);
    }
    .actions{
      display:flex;
      justify-content:flex-end;
      gap:10px;
      flex-wrap:wrap;
      margin-top:14px;
    }

    /* ===== Footer ===== */
    footer{
      margin-top:80px;
      text-align:center;
      padding:20px 0;
      border-top:1px solid var(--line);
      color:var(--muted);
      font-size:13px;
      background:var(--surface);
    }

    @media (max-width: 900px){
      .form-grid{grid-template-columns: 1fr;}
    }
  </style>
</head>

<body>
<header>
  <div class="main_div_header">
    <h1><a class="logo-link" href="/index.html">CoreON</a></h1>
    <h3>ì¼ì˜ ì¤‘ì‹¬ì´ ë˜ëŠ” ê³³</h3>

    <nav class="top-nav">
      <a href="/board/list.html" class="nav-item active">ê²Œì‹œíŒ</a>
      <a href="/board/notice.html" class="nav-item">ê³µì§€</a>
      <a href="/faq/faq.html" class="nav-item">FAQ</a>
      <a href="/auth/login.html" class="nav-item action">ë¡œê·¸ì¸</a>
      <a href="/auth/regist.html" class="nav-item action primary">íšŒì›ê°€ì…</a>
    </nav>
  </div>
</header>

<main>
  <div class="page-head">
    <div class="page-title">
      <h2>ìë£Œ ë“±ë¡</h2>
      <p>ì‚¬ë‚´ ê³µë¬¸/ì–‘ì‹/ê³µìœ  ìë£Œë¥¼ ë“±ë¡í•©ë‹ˆë‹¤. ì œëª©ê³¼ ë¶„ë¥˜ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.</p>
    </div>
  </div>

  <section class="card">
    <div class="card-head">
      <div>
        <p class="title">ê²Œì‹œê¸€ ì‘ì„±</p>
        <p class="desc">ë“±ë¡ í›„ ëª©ë¡ì—ì„œ ë¬¸ì„œ ìš”ì•½ ê¸°ëŠ¥(Bedrock)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í™•ì¥ ì˜ˆì •ì…ë‹ˆë‹¤.</p>
      </div>
    </div>

    <div class="card-body">
      <form id="attachForm" onsubmit="return false;">
        <div class="form-grid">
          <!-- ì œëª© (í•„ìˆ˜) -->
          <div class="field full">
            <label for="title">ì œëª©<span class="required">*</span></label>
            <input id="title" name="title" class="input" type="text" placeholder="ì˜ˆ) 2026ë…„ ë³´ì•ˆ êµìœ¡ ì•ˆë‚´ ê³µë¬¸" />
            <div class="error" id="titleError">ì œëª©ì€ í•„ìˆ˜ ì…ë ¥ì…ë‹ˆë‹¤.</div>
          </div>

          <!-- ë¶„ë¥˜ (í•„ìˆ˜) -->
          <div class="field">
            <label for="category">ë¶„ë¥˜<span class="required">*</span></label>
            <select id="category" name="category" class="select">
              <option value="">ì„ íƒ</option>
              <option value="ê³µì§€ì„±">ê³µë¬¸ì„±</option>
              <option value="ê³µë¬¸/ì–‘ì‹">ê³µë¬¸/ì–‘ì‹</option>
              <option value="ê³µìœ ìë£Œ">ê³µìœ ìë£Œ</option>
            </select>
            <div class="error" id="categoryError">ë¶„ë¥˜ëŠ” í•„ìˆ˜ ì„ íƒì…ë‹ˆë‹¤.</div>
          </div>

          <!-- ë¶€ì„œ (ì„ íƒ) -->
          <div class="field">
            <label for="dept">ë¶€ì„œ</label>
            <input id="dept" name="dept" class="input" type="text" placeholder="ì˜ˆ) IT ìš´ì˜íŒ€" />
            <div class="help">ì„ íƒ ì…ë ¥ (ì¶”í›„ ë¡œê·¸ì¸ ì‚¬ìš©ì ë¶€ì„œ ìë™ ì„¸íŒ… ê°€ëŠ¥)</div>
          </div>

          <!-- ë³¸ë¬¸ -->
          <div class="field full">
            <label for="content">ë‚´ìš©</label>
            <textarea id="content" name="content" class="textarea" placeholder="ë¬¸ì„œ ìš”ì•½ì´ ê°€ëŠ¥í•˜ë„ë¡ í•µì‹¬ ë‚´ìš©ê³¼ ë°°ê²½ì„ ê°„ë‹¨íˆ ì‘ì„±í•´ ì£¼ì„¸ìš”."></textarea>
            <div class="help">ë“±ë¡ í›„ Bedrock ìš”ì•½ ê¸°ëŠ¥ì—ì„œ ë³¸ë¬¸/ì²¨ë¶€ íŒŒì¼ ë‚´ìš©ì„ ìš”ì•½í•  ìˆ˜ ìˆë„ë¡ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
          </div>

          <!-- íŒŒì¼ ì—…ë¡œë“œ -->
          <div class="field full">
            <label for="files">ì²¨ë¶€íŒŒì¼</label>
            <input id="files" name="files" class="input" type="file" multiple />
            <div class="help">PDF/DOCX/XLSX ë“± ì‚¬ë‚´ ê³µìœ  ë¬¸ì„œë¥¼ ì²¨ë¶€í•˜ì„¸ìš”. (í˜„ì¬ëŠ” UIë§Œ ì œê³µ)</div>
          </div>
        </div>

        <div class="actions">
          <button class="btn" type="button" onclick="location.href='/board/list.html'">ì·¨ì†Œ</button>
          <button class="btn ghost" type="button" onclick="saveDraft()">ì„ì‹œì €ì¥(ë¡œì»¬)</button>
          <button class="btn primary" type="button" onclick="submitPost()">ë“±ë¡</button>
        </div>
      </form>
    </div>
  </section>
</main>

<footer>
  Copyright CoreON
</footer>

<script>
  // ===== ê°„ë‹¨ ìœ íš¨ì„± ê²€ì‚¬ =====
  function validate(){
    const title = document.getElementById("title").value.trim();
    const category = document.getElementById("category").value;

    const titleError = document.getElementById("titleError");
    const categoryError = document.getElementById("categoryError");

    let ok = true;

    if(!title){
      titleError.style.display = "block";
      ok = false;
    }else{
      titleError.style.display = "none";
    }

    if(!category){
      categoryError.style.display = "block";
      ok = false;
    }else{
      categoryError.style.display = "none";
    }

    return ok;
  }

  // ===== ì„ì‹œì €ì¥(ë¡œì»¬) =====
  function saveDraft(){
    const draft = {
      title: document.getElementById("title").value,
      category: document.getElementById("category").value,
      dept: document.getElementById("dept").value,
      content: document.getElementById("content").value
    };
    localStorage.setItem("board_attach_draft", JSON.stringify(draft));
    alert("ì„ì‹œì €ì¥ ì™„ë£Œ(ë¸Œë¼ìš°ì € ë¡œì»¬).");
  }

  // ===== ë¡œë“œ ì‹œ ì„ì‹œì €ì¥ ë³µì› =====
  window.addEventListener("load", () => {
    const raw = localStorage.getItem("board_attach_draft");
    if(!raw) return;
    try{
      const d = JSON.parse(raw);
      if(d?.title) document.getElementById("title").value = d.title;
      if(d?.category) document.getElementById("category").value = d.category;
      if(d?.dept) document.getElementById("dept").value = d.dept;
      if(d?.content) document.getElementById("content").value = d.content;
    }catch(e){}
  });

  // ===== ë“±ë¡ (ë°±ì—”ë“œ ë¶™ì¼ ì¤€ë¹„: FormData) =====
  async function submitPost(){
    if(!validate()) return;

    const form = document.getElementById("attachForm");
    const fd = new FormData(form);

    // âœ… files input nameì´ "files"ë¼ì„œ ë©€í‹°íŒŒì¼ë„ ê·¸ëŒ€ë¡œ ë“¤ì–´ê°
    // fd.get("title"), fd.get("category") ë“± í™•ì¸ ê°€ëŠ¥

    try{
      // ğŸš© ì—¬ê¸° URLì€ ë„ˆ ë°±ì—”ë“œì— ë§ê²Œ êµì²´
      // ì˜ˆì‹œ: /api/board/posts (multipart/form-data)
      const res = await fetch("/api/board/posts", {
        method: "POST",
        body: fd,
        credentials: "include"
      });

      // ì•„ì§ ë°±ì—”ë“œê°€ ì—†ìœ¼ë©´ ì´ ë¶€ë¶„ì—ì„œ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŒ
      if(!res.ok){
        const t = await res.text().catch(()=> "");
        alert("ë“±ë¡ ì‹¤íŒ¨: " + res.status + (t ? ("\n" + t) : ""));
        return;
      }

      alert("ë“±ë¡ ì™„ë£Œ");
      // ì„ì‹œì €ì¥ ì œê±°(ì„ íƒ)
      localStorage.removeItem("board_attach_draft");
      location.href = "/board/list.html";
    }catch(e){
      console.error(e);
      alert("ì„œë²„ ì—°ê²° ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ë°±ì—”ë“œ ì—°ê²° ì „ì´ë©´ ì •ìƒ)");
    }
  }
</script>
</body>
</html>
